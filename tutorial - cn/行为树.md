## è¡Œä¸ºæ ‘

- [è¡Œä¸ºæ ‘](#è¡Œä¸ºæ ‘)
  - [è¡Œä¸ºèŠ‚ç‚¹](#è¡Œä¸ºèŠ‚ç‚¹)
  - [ç»„åˆèŠ‚ç‚¹](#ç»„åˆèŠ‚ç‚¹)

æœ¬èŠ‚æ•™ç¨‹å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨`è¡Œä¸ºæœº`çš„è¡Œä¸ºğŸŒ²éƒ¨åˆ†ã€‚ä¸è¿‡ç¡®åˆ‡çš„è¯´ï¼Œæ‚¨å®Œå…¨ä¸å¿…å­¦ä¹ æ­¤ç« èŠ‚ï¼Œå› ä¸ºä»…å‡­çŠ¶æ€æœºä¹Ÿå¯ä»¥é¡ºç•…åœ°æ¸¸ç©æ¸¸æˆã€‚

### è¡Œä¸ºèŠ‚ç‚¹

`CreepLogic`ç»§æ‰¿è‡ª`Stage`ç±»ï¼Œå› æ­¤å…¶å…·å¤‡`è¡Œä¸ºæœº`ç‰¹æ€§ã€‚å…¶æ ¸å¿ƒæ˜¯çŠ¶æ€èŠ‚ç‚¹ï¼Œå½“æ¯ä¸ªçŠ¶æ€èŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œé€šè¿‡è¿”å›å€¼æ¥åˆ‡æ¢çŠ¶æ€ã€‚ è¿”å›å€¼ç±»å‹å†³å®šæ‰§è¡Œæ–¹å¼ï¼š

* è¿”å›ä¸‹ä¸ªçŠ¶æ€çš„å­—ç¬¦ä¸²æ¥åˆ‡æ¢çŠ¶æ€ã€‚
* è¿”å›`è¡Œä¸ºç»“æœ`æ¥åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªè¡Œä¸ºçŠ¶æ€ã€‚

| è¡Œä¸ºç»“æœ      | ç­‰åŒå€¼     | æè¿°             |
|-----------|---------|----------------|
| `SUCCESS` | `True`  | æˆåŠŸï¼Œåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªè¡Œä¸ºçŠ¶æ€  |
| `FAILURE` | `False` | å¤±è´¥ï¼Œå›æº¯åˆ°ä¸Šä¸€ä¸ªå…³é”®èŠ‚ç‚¹  |
| `RUNNING` | `None`  | è¿è¡Œä¸­ï¼Œè¡¨ç¤ºå½“å‰çŠ¶æ€å°šæœªç»“æŸ |

è¿”å›`SUCCESS`æ—¶ï¼Œä¼šåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªè¡Œä¸ºçŠ¶æ€ã€‚é€šè¿‡ä¸ºè¯¥èŠ‚ç‚¹è£…é¥°`@behavior`ï¼Œå¯ä»¥æ³¨å†Œå…¶ä¸ºä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼›
å¦‚æœè¿”å›`è¡Œä¸ºç»“æœ`çš„èŠ‚ç‚¹æ²¡æœ‰è¢«è£…é¥°ï¼Œé‚£ä¹ˆä¼šå°è¯•å›åˆ°æ ˆä¸Šçš„ä¸Šä¸€ä¸ª`ç»„åˆèŠ‚ç‚¹`æˆ–è€…æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œå¦åˆ™ä¼šäº§ç”Ÿä¸€ä¸ªè­¦å‘Šï¼Œå¹¶ä¸”çŠ¶æ€ä¼šä¸€ç›´ä¿æŒã€‚

```python
class Demo(Logic):
    NAME = "Demo"

    def start(self):
        return "run"

    @behavior("idle")
    def run(self):
        return SUCCESS

    def idle(self):
        return SUCCESS

```

<p align="center">
<img src="../pic/Behavior_image1.png" alt="Demoæµç¨‹å›¾">
</p>

æ‰§è¡Œé¡ºåº: start -> (run -> idle) -> (run -> idle) - ...

**æ³¨æ„**: å¦‚æœåœ¨è¡Œä¸ºæ ‘ä¸­ï¼ŒæŸä¸ªèŠ‚ç‚¹è¿”å›äº†å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆè¡Œä¸ºæ ‘ä¸Šä¸‹æ–‡å°†ä¼šä¸¢å¤±ã€‚

### ç»„åˆèŠ‚ç‚¹

è¡Œä¸ºèŠ‚ç‚¹åå¯ä»¥ç´§è·Ÿä¸€ä¸ªç»„åˆèŠ‚ç‚¹(æ˜¯çš„ï¼Œåªèƒ½è·Ÿåœ¨è¡Œä¸ºèŠ‚ç‚¹åé¢)ã€‚ç»„åˆèŠ‚ç‚¹æœ‰3ç§ç±»å‹:

| ç»„åˆèŠ‚ç‚¹        | æè¿°                                                 |
|-------------|----------------------------------------------------|
| `@sequence` | é¡ºåºæ‰§è¡Œå­èŠ‚ç‚¹ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå­èŠ‚ç‚¹è¿”å›`FAILURE`ï¼Œæˆ–è€…æ‰€æœ‰å­èŠ‚ç‚¹éƒ½è¿”å›`SUCCESS`    |
| `@selector` | é¡ºåºæ‰§è¡Œå­èŠ‚ç‚¹ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå­èŠ‚ç‚¹è¿”å›`SUCCESS`ï¼Œæˆ–è€…æ‰€æœ‰å­èŠ‚ç‚¹éƒ½è¿”å›`FAILURE`    |
| `@parallel` | å¹¶è¡Œæ‰§è¡Œå­èŠ‚ç‚¹ï¼Œç­‰ä»·äº `selector`ï¼Œä½†æ˜¯è¿”å›`RUNNING`çš„å­èŠ‚ç‚¹ä¸ä¼šé˜»ç¢åç»­èŠ‚ç‚¹æ‰§è¡Œ |

```python
class Demo(Logic):
    """
    ç­‰å¾…å¯¹æ–¹çš„é¦–ä¸ªæœ‰æ•ˆå•ä½ã€‚
    â‘ å¦‚æœå«WORKï¼Œå“åº”ä¸€ä¸ªæ”»å‡»å•ä½
    â‘¡å¦‚æœæ˜¯æ”»å‡»å•ä½ï¼Œå“åº”2ä¸ªæ”»å‡»å•ä½
    â‘¢å¦‚æœ200tickéƒ½æ²¡æœ‰å•ä½å‡ºç°ï¼Œåˆ‡æ¢åˆ°idleçŠ¶æ€
    """
    NAME = "Demo"
    
    def onLoading(self):
        self.ec_trigger = Component(lambda :ESPAWN.creep).add(Trigger())
    
    @parallel("timeout_200", "wait_enemy")
    def start(self):
        return SUCCESS
    
    def timeout_200(self):
        if know.now >= 200: return "idle"
    
    @selector("is_worker", "is_attacker")
    def wait_enemy(self):
        return self.ec_trigger()

    def is_worker(self):
        if st.workable(ESPAWN.creep):
            self.enlist_count = 1
            return "enlist"
        return FAILURE

    def is_attacker(self):
        if st.atkable(ESPAWN.creep):
            self.enlist_count = 2
            return "enlist"
        return FAILURE

    def enlist(self):
        for i in range(self.enlist_count):
            Logic("Soldier", SPAWN)
        return "idle"
    
    def idle(self):
        pass
```

<p align="center">
<img src="../pic/Behavior_image2.png" alt="Demoæµç¨‹å›¾">
</p>

