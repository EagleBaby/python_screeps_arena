
## 7. 创建新Creep
  - [获取对象](#获取对象)
  - [爬虫配方](#爬虫配方)
  - [孵化爬虫](#孵化爬虫)
  - [最终代码](#最终代码)

本节教程将介绍如何创建Creep。

通过`spawn`对象(<i>StructureSpawn，简称为spawn</i>)可创建新的Creep。

本节提供1个`spawn`对象和2个`flag`，需创建两个Creep并移动到对应`flag`位置。

### 获取对象

首先获取所需对象：
```python
from builtin import *

SPAWN = get.spawn()
FLAG0 = get.flag(lambda it: it.x < SPAWN.x)
FLAG1 = get.flag(lambda it: it.x > SPAWN.x)


def init(k: GlobalKnowledge):
    pass


def step(k: GlobalKnowledge):
    pass
```


### 爬虫配方

创建Creep前需确定其`recipe`（身体组件配置）。以下是Creep身体组件列表：

| 组件名 | 行动类别 | 价格 | 描述 |
|-------|---------|------|------|
| MOVE | 其他 | 50 | 每tick降低fatigue值2点，无MOVE组件无法移动 |
| CARRY | 资源 | 50 | 提供50点资源容量，有资源时产生移动疲劳 |
| ATTACK | 近程 | 80 | 30点近战伤害，攻击距离1 |
| RANGED_ATTACK | 远程 | 150 | 10点远程伤害，攻击距离3，可造成AOE伤害 |
| HEAL | 近程/远程 | 250 | 近程12点治疗，远程4点治疗，距离3 |
| WORK | 近程(采集)/远程(建造) | 100 | 建造速度5/tick，采集能量2/tick |
| TOUGH | 其他 | 10 | 仅提供生命值，无特殊功能 |

例如：
- 可移动的Creep配方：`[MOVE]`
- 近战单位配方：`[MOVE, ATTACK]`



### 孵化爬虫

`create` 是 `StructureSpawn` 类的实例方法，用于创建新的 Creep：

| 参数名 | 类型 | 可选 | 默认值 | 描述 |
|-------|------|------|--------|------|
| `recipe` | `list[str]` \| `str` | 否 | - | 用于创建 creep 的身体部位数组或字符串 |
| `creep_name` | `str` \| `None` | 是 | `None` | 可选的 creep 名称，未填写时会生成形如'c' + id的格式 |
| `optimise` | `bool` \| `int` \| `float` \| `list` | 是 | `True` | 优化配方参数，支持五种形式：<br>- `True`: 启用 fit 优化，使用默认能量上限<br>- `int`(非0): 启用 fit 优化，指定能量上限<br>- `float`(0-1): 启用 fit 优化，按比例应用默认能量上限<br>- `list`: 多项式系数列表，计算能量上限<br>- `False`/`None`: 不启用优化 |
| `direction` | `int` \| `None` | 是 | `None` | 可选的诞生方向参数，例如指定TOP时会按[↑ ↖ ↗]顺序尝试，若均被阻挡则创建失败 |

| 返回值类型 | 描述 |
|-----------|------|
| `int` \| `Creep` | 成功返回creep或剩余孵化时间(>0)，失败返回小于0的错误码 |

**错误码**：
- `OK` (0): 操作成功
- `ERR_NOT_OWNER` (-1): 非 Spawn 拥有者
- `ERR_INVALID_ARGS` (-10): 参数不正确
- `ERR_NOT_ENOUGH_ENERGY` (-6): 能量不足
- `ERR_SPAWN_BUSY` (-4): Spawn 正在忙碌
- `ERR_INVALID_TARGET` (-7): 目标无效

*使用`st.creep`判断返回值是否为creep，比`isinstance`更严谨。

**示例**：创建两个配方为`[MOVE]`的Creep，诞生方位分别为LEFT和RIGHT

```python
from builtin import *

SPAWN = get.spawn()
FLAG0 = get.flag(lambda it: it.x < SPAWN.x)
FLAG1 = get.flag(lambda it: it.x > SPAWN.x)

CREEP0 = None
CREEP1 = None

def init(k: GlobalKnowledge):
    pass


def step(k: GlobalKnowledge):
    global CREEP0, CREEP1
    if not st.creep(CREEP0):
        CREEP0 = SPAWN.create([MOVE], "Mover0", True, LEFT)
    if not st.creep(CREEP1):
        CREEP1 = SPAWN.create([MOVE], "Mover1", True, RIGHT)
```

### 最终代码

创建两个Creep并移动到对应Flag的完整代码：

```python
from builtin import *

SPAWN = get.spawn()
FLAG0 = get.flag(lambda it: it.x < SPAWN.x)
FLAG1 = get.flag(lambda it: it.x > SPAWN.x)

CREEP0 = None
CREEP1 = None

def init(k: GlobalKnowledge):
    pass

def step(k: GlobalKnowledge):
    global CREEP0, CREEP1

    # 创建阶段
    if not st.creep(CREEP0):
        CREEP0 = SPAWN.create([MOVE], "Mover0", True, LEFT)
    if not st.creep(CREEP1):
        CREEP1 = SPAWN.create([MOVE], "Mover1", True, RIGHT)

    # 执行阶段
    if st.creep(CREEP0):
        CREEP0.move(FLAG0)
    if st.creep(CREEP1):
        CREEP1.move(FLAG1)
```




